---
layout: post
title: MongoDB的架构
categories: [db]
description: 主要区别于RDBMS
keywords: mongo, database
catalog: true
multilingual: false
tags: mongo
---

## 前言
最近尝试用MongoDB替换Mysql， 由于Mysql的写能力限制， 32C128G的实例同时写入1M的数据CPU飙升， 更不用说如果是并发的情况。

### 与RBDMS的主要区别
MongoDB和RDBMS的主要区别在于：
- RBDMS的数据记录是`平`， 而MongoDB的数据单元`Document`是可以嵌入的，比如一个CSV文件， 一个字段是一个值， 但是mongo可以使用Bson, 一个字段可以存储多个值`{'key': [v1,v2]}`.通过组合还可以生成更多复杂的数据结构。
- RBDMS所有的数据结构`schema`必须预定义， 而`Document`可以存储任何结构的数据。
- MongoDB是没有`join`查询操作的。 RBDMS数据库设计的核心讲究`Normalization`, 数据越结构化，冗余越少越好。 而MongoDB鼓励`denormalized`, 通过数据冗余做到`join`查询。
- MongoDB的数据一致性需要客户端来维护， mongo没有`ACID`的`Isolation`概念， 一个并发客户端可能读到另一个并发用户修改数据。
- `transaction`事务也是不存在，（**注意， 4.0这个版本支持ACID的事务**）。原子性操作只能做到document级别。
而正是移除关系型数据库一部分特性， mongo才能做到更加可扩展和轻量级， 这两条正适合处理大数据。

### 查询处理
mongo的`Collection`可以认为是关系型数据库的`table`， `Document`可以认为是关系型数据库的`records`.